#!/bin/bash

echo '[*] Writing Flag Files. . .'

echo $FLAG1 > /home/programmer/flag.txt
echo $FLAG2 > /home/programmer2/flag.txt
echo $FLAG3 > /home/programmer3/flag.txt
echo $FLAG4 > /home/programmer4/flag.txt
echo $FLAG5 > /home/programmer5/flag.txt

echo '[*] Clearing ENV. . .'

# clear from env so users cannot see flags
# for other challenges
unset FLAG1
unset FLAG2
unset FLAG3
unset FLAG4
unset FLAG5

echo '[*] Compiling Binaries. . .'

# create vuln bins
gcc /home/programmer/vuln.c  -o /home/programmer/vuln  -fno-stack-protector -no-pie
gcc /home/programmer2/vuln.c -o /home/programmer2/vuln -fPIE -pie
gcc /home/programmer3/vuln.c -o /home/programmer3/vuln -fno-stack-protector -no-pie -z execstack
gcc /home/programmer4/vuln.c -o /home/programmer4/vuln -fno-stack-protector -no-pie -z execstack
gcc /home/programmer5/vuln.c -o /home/programmer5/vuln -fno-stack-protector -no-pie -z execstack

echo '[*] Fixing Ownerships. . .'

# Change ownerships
chown -R programmer:programmer /home/programmer
chown -R programmer:programmer2 /home/programmer2
chown -R programmer:programmer3 /home/programmer3
chown -R programmer:programmer4 /home/programmer4
chown -R programmer:programmer5 /home/programmer5

echo '[+] Finished!'