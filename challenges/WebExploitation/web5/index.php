<?php
$request = $_SERVER['REQUEST_URI'];

// Extract the path and query parameters
$parsedUrl = parse_url($request);
$path = $parsedUrl['path']; // the URI path without query parameters
$query = isset($parsedUrl['query']) ? $parsedUrl['query'] : '';

// load a specific page based on the URI
switch ($path) {
    case '/': // Homepage
    case '':
        require __DIR__ . '/home.php';
        break;
    case '/login':
        require __DIR__ . '/login.php';
        break;
    case '/logout':
        require __DIR__ . '/logout.php';
        break;
    case '/admin':
        require __DIR__ . '/admin.php';
        break;
    case '/story': // Handle story page with query
        parse_str($query, $params);
        if (isset($params['story'])) {
            $story = $params['story'];
            $filePath = 'stories/' . $story;
            if (file_exists($filePath)) {
                require __DIR__ . '/story.php';
            } else {
                http_response_code(404);
                echo "Story not found!";
            }
        } else {
            http_response_code(400);
            echo "Bad request: missing story parameter!";
        }
        break;
    default:
        http_response_code(404);
        echo "404 Not Found";
        break;
}