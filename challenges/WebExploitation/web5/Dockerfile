# Use a lightweight PHP image
FROM php:8.2-cli

# Install Firefox + dependencies
RUN apt-get update && apt-get install -y \
    acl \
    && rm -rf /var/lib/apt/lists/*

# Set working directory
WORKDIR /var/www/html/app

# move app code
COPY *.php ./
COPY css/ ./css/
COPY stories/ ./stories/
COPY images/ ./images/

# Adjust ownership so www-data can access the app files
RUN chown -R www-data:www-data /var/www/html/

# Switch to non-root user
USER www-data

# Expose the port Flask will run on (default 5000)
EXPOSE 8080

# Run the php app
CMD ["php", "-S", "0.0.0.0:8080", "-t", "."]